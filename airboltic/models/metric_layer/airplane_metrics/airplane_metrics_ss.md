<!-- markdownlint-disable MD041 -->
{% docs airplane_metrics_ss %}

# airplane_metrics_ss

## Description
This model calculates aggregated metrics for airplanes, including total trips, total customers, total revenue, and total flight time. It combines airplane details with trip data to output insights at the airplane level for reporting and analysis.

---

## Data Sources
1. **Airplane Details**
   - Reference: `airplane_details_ow`
   - Provides detailed specifications for each airplane, such as manufacturer, model, and capacity.

2. **Trip Details**
   - Reference: `trip_details_ss`
   - Contains trip-specific information, including customer IDs, prices, and flight durations.

---

## Logic Overview

### 1. **`airplane_metrics` CTE**
   - Joins airplane details with trip data:
     - Calculates aggregated metrics:
       - `total_trips`: Number of distinct trips for each airplane.
       - `total_customers`: Number of distinct customers served by the airplane.
       - `total_revenue`: Sum of revenue generated by the airplane's trips.
       - `total_flight_time_minutes`: Total flight time for all trips.
     - Groups data by key airplane attributes and `trip_end_date`.

### Final Output
The query outputs aggregated metrics for each airplane, grouped by:
- `airplane_id`
- `manufacturer`
- `model`
- `max_seats`
- `max_weight`
- `max_distance`
- `engine_type`
- `trip_end_date`

---

## Use Cases
1. Analyzing airplane utilization and efficiency.
2. Reporting on revenue and customer engagement per airplane.
3. Supporting decisions on fleet management and optimization.

---

## Incremental Logic
- The model is incremental with a `merge` strategy:
  - New or updated rows are merged based on the unique key.
  - Ensures efficient processing and avoids duplicate data.

---

## Considerations
1. **Null Handling**:
   - Ensure that `trip_details_ss` and `airplane_details_ow` contain valid and complete data.
2. **Performance**:
   - Optimized with the Delta file format for efficient updates.

{% enddocs %}
